@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --background: #020617;
  --foreground: #f8fafc;
  --muted: #0f172a;
  --muted-foreground: #a7b0c0;
  --border: #1e293b;
  --accent: #3b82f6;
  --accent-foreground: #f8fafc;
  --surface: #0f172a;
  --surface-elevated: #111c33;
  --accent-rgb: 59 130 246;
  --accent-glow-rgb: 52 211 153;
  --foreground-rgb: 248 250 252;
  --background-rgb: 2 6 23;
  --danger: #f87171;
  --danger-foreground: #0f172a;

  /* ===== UNIFIED BACKGROUND SYSTEM ===== */
  /* Base colors (shared between intro and site) */
  --bg-accent-color: var(--accent-rgb);
  --bg-glow-color: var(--accent-glow-rgb);

  /* Site mode (default) - subtle corner gradients */
  --bg-primary-opacity: 0.14;
  --bg-secondary-opacity: 0.10;
  --bg-blur: 50px;
  --bg-scale: 1;

  /* Noise overlay */
  --bg-noise-opacity: 0.04;

  /* ===== PAGE SURFACE SYSTEM ===== */
  /* Main content sheet - translucent so neural mesh shows through */
  --page-surface-opacity: 0.88;
  --page-surface: rgba(2, 6, 23, var(--page-surface-opacity));

  /* Section surface - for highlighted sections */
  --section-surface-opacity: 0.6;
  --section-surface: rgba(15, 23, 42, var(--section-surface-opacity));
}

/* Mobile: slightly more opaque for readability */
@media (max-width: 767px) {
  :root {
    --page-surface-opacity: 0.96;
    --section-surface-opacity: 0.75;
  }
}

@media (prefers-color-scheme: dark) {
  :root {
    --background: #020617;
    --foreground: #f8fafc;
    --muted: #0f172a;
    --muted-foreground: #a7b0c0;
    --border: #1e293b;
    --accent: #3b82f6;
    --accent-foreground: #f8fafc;
    --surface: #0f172a;
    --surface-elevated: #111c33;
    --accent-rgb: 59 130 246;
    --accent-glow-rgb: 52 211 153;
    --foreground-rgb: 248 250 252;
    --background-rgb: 2 6 23;
    --danger: #f87171;
    --danger-foreground: #0f172a;

    --bg-gradient-opacity: 0.18;
    --bg-glow-opacity: 0.14;
    --bg-noise-opacity: 0.05;
  }
}

/* Lenis Smooth Scroll */
html.lenis,
html.lenis body {
  height: auto;
}

.lenis.lenis-smooth {
  scroll-behavior: auto !important;
}

.lenis.lenis-smooth [data-lenis-prevent] {
  overscroll-behavior: contain;
}

.lenis.lenis-stopped {
  overflow: hidden;
}

.lenis.lenis-smooth iframe {
  pointer-events: none;
}

/* Base Styles */
* {
  box-sizing: border-box;
  padding: 0;
  margin: 0;
}

html {
  scroll-behavior: smooth;
  background-color: #020617 !important;
}

@media (prefers-reduced-motion: reduce) {
  html {
    scroll-behavior: auto;
  }
}

body {
  background: var(--background) !important;
  background-color: #020617;
  color: var(--foreground);
  font-family: var(--font-sans), system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Premium dark background system */
body {
  position: relative;
}

/* Body backgrounds moved to GlobalBackground.tsx component */

/* ===== UNIFIED BACKGROUND LAYER ===== */
/* Shared mesh gradient - used by both intro and site */
.unified-bg-mesh {
  position: absolute;
  inset: -20vmax;
  pointer-events: none;
  will-change: opacity, transform;
  transition: opacity 0.8s ease-out, transform 0.8s ease-out, filter 0.8s ease-out;

  /* 4-corner gradient system */
  background:
    radial-gradient(ellipse 80% 60% at 20% 30%, rgb(var(--bg-accent-color) / var(--bg-primary-opacity)) 0%, transparent 60%),
    radial-gradient(ellipse 70% 50% at 85% 20%, rgb(var(--bg-glow-color) / var(--bg-secondary-opacity)) 0%, transparent 55%),
    radial-gradient(ellipse 60% 50% at 75% 85%, rgb(var(--bg-accent-color) / var(--bg-secondary-opacity)) 0%, transparent 55%),
    radial-gradient(ellipse 70% 60% at 10% 80%, rgb(var(--bg-glow-color) / var(--bg-secondary-opacity)) 0%, transparent 60%);

  filter: blur(var(--bg-blur));
  transform: scale(var(--bg-scale));
  opacity: 0.85;
}

/* Intro mode - stronger, more focused gradients */
[data-bg-mode="intro"] .unified-bg-mesh,
.unified-bg-mesh--intro {
  --bg-primary-opacity: 0.22;
  --bg-secondary-opacity: 0.16;
  --bg-blur: 35px;
  --bg-scale: 1.05;
  opacity: 1;
  animation: mesh-breathing 20s ease-in-out infinite alternate;
}

/* Site mode - subtle, ambient gradients */
[data-bg-mode="site"] .unified-bg-mesh,
.unified-bg-mesh--site {
  --bg-primary-opacity: 0.14;
  --bg-secondary-opacity: 0.10;
  --bg-blur: 50px;
  --bg-scale: 1;
  opacity: 0.85;
  animation: none;
}

/* Transition between modes */
[data-bg-mode="transitioning"] .unified-bg-mesh {
  transition: opacity 1s ease-out, transform 1s ease-out, filter 1s ease-out;
}

/* Static noise overlay */
.unified-bg-noise {
  position: absolute;
  inset: 0;
  pointer-events: none;
  opacity: var(--bg-noise-opacity);
  mix-blend-mode: overlay;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.05'/%3E%3C/svg%3E");
}

/* Mobile optimizations */
@media (max-width: 768px) {
  .unified-bg-mesh {
    --bg-blur: 30px;
    --bg-primary-opacity: 0.12;
    --bg-secondary-opacity: 0.08;
    animation: none !important;
  }

  .unified-bg-noise {
    display: none;
  }
}

/* Reduced motion - instant transitions */
@media (prefers-reduced-motion: reduce) {
  .unified-bg-mesh {
    transition: none !important;
    animation: none !important;
  }
}

/* Text sweep animation - light passes through letters */
.intro-text-sweep {
  /* Gradient positioned off-screen left initially */
  background: linear-gradient(90deg,
      transparent 0%,
      transparent 35%,
      rgb(var(--accent-rgb)) 45%,
      rgb(var(--accent-glow-rgb)) 50%,
      rgb(var(--accent-rgb)) 55%,
      transparent 65%,
      transparent 100%);
  background-size: 300% 100%;
  background-position: 100% 0;
  /* Start off-screen right (sweep will go left-to-right visually) */
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  opacity: 0;
}

/* When animation is active */
.intro-text-sweep.sweeping {
  opacity: 1;
  animation: intro-sweep 1s ease-in-out forwards;
}

/* After sweep completes - text returns to white */
.intro-text-sweep.sweep-done {
  opacity: 0;
}

@keyframes intro-sweep {
  0% {
    background-position: 100% 0;
  }

  100% {
    background-position: -100% 0;
  }
}

/* Reduced motion - no sweep animation */
@media (prefers-reduced-motion: reduce) {
  .intro-text-sweep {
    display: none;
  }
}

@keyframes mesh-breathing {
  0% {
    transform: scale(1);
    opacity: 0.8;
  }

  100% {
    transform: scale(1.1);
    opacity: 0.6;
  }
}


@media (max-width: 768px) {
  .intro-bg {
    filter: blur(30px);
    animation: none;
  }
}

@layer base {
  p {
    @apply leading-relaxed;
  }
}

/* Selection */
::selection {
  background: var(--accent);
  color: var(--accent-foreground);
}

/* Focus Styles */
:focus-visible {
  outline: 2px solid var(--accent);
  outline-offset: 2px;
}

/* Link Styles */
a {
  color: inherit;
  text-decoration: none;
}

/* Smooth Image Loading */
img {
  max-width: 100%;
  height: auto;
}

/* Custom Scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: var(--muted);
}

::-webkit-scrollbar-thumb {
  background: var(--muted-foreground);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--foreground);
}

/* Utility Classes */
@layer utilities {
  .text-balance {
    text-wrap: balance;
  }

  .text-gradient {
    background: linear-gradient(135deg, var(--foreground) 0%, var(--muted-foreground) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
}